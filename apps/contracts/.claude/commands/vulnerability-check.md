description: Check for common vulnerabilities in Solidity contracts
argument-hint: [contract_file.sol]
allowed-tools: Bash(cat:), Bash(grep:)
Perform comprehensive check for common vulnerabilities in: $ARGUMENTS

üö® Top 10 Solidity Vulnerabilities 2024

1. Reentrancy Attacks
   // ‚ùå VULNERABLE
   function withdraw() external {
   uint amount = balances[msg.sender];
   (bool success,) = msg.sender.call{value: amount}("");
   balances[msg.sender] = 0; // State change AFTER external call
   }

// ‚úÖ SECURE
function withdraw() external nonReentrant {
uint amount = balances[msg.sender];
balances[msg.sender] = 0; // State change BEFORE external call
(bool success,) = msg.sender.call{value: amount}("");
} 2. Access Control Issues
Functions without appropriate access modifiers

Incorrect use of tx.origin vs msg.sender

Lack of role-based access control

3. Integer Overflow/Underflow
   Verify use of Solidity 0.8+ or SafeMath

Arithmetic operations without validation

Inappropriate use of unchecked

4. Timestamp Dependence
   Use of block.timestamp for critical logic

Time manipulation by miners

Safer alternatives

5. Denial of Service (DoS)
   Unbounded loops that can exhaust gas

External calls that may fail

Pull vs push payment patterns

6. Front-running/MEV
   Predictable transactions

Lack of commit-reveal schemes

Insufficient slippage protection

7. Flash Loan Attacks
   Oracle price manipulation

Dependency on instantaneous balances

Lack of liquidity validations

8. Signature Replay
   Reuse of valid signatures

Lack of nonces or timestamps

Cross-chain replay attacks

9. Uninitialized Storage
   Uninitialized storage variables

Dangerous storage pointers

Missing constructors

10. Delegatecall Injection
    Unsafe use of delegatecall

Proxy implementation vulnerabilities

Storage collision attacks

üîç Automated Analysis
For each vulnerability found, provide:

Severity: CRITICAL/HIGH/MEDIUM/LOW

Specific code line

Risk explanation

Example code for the fix

References to known exploits

üõ°Ô∏è Mitigation Recommendations
Implement OpenZeppelin security patterns

Use tools like Slither, Mythril, Securify

Perform comprehensive testing with Foundry/Hardhat

Consider professional audits for critical contracts

Analyze the provided code and generate a detailed report with all vulnerabilities found and their solutions.
